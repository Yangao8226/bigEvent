import{q as g,s as p,W as E,o as l,a as _,w as o,y as d,v as r,I as k,x as i,bL as w,J as U,E as x,F as A}from"./index-BZ6anzCx.js";import{_ as I,E as S}from"./_plugin-vue_export-helper-bd0Rmxjf.js";import{E as C}from"./el-progress-2Eptdr0U.js";import{P as B}from"./PageContainer-Cgg-xLYz.js";import"./_baseClone-BqTtZK27.js";import"./isEqual-JJC-WhTM.js";const b=s=>(x("data-v-2b0c9f31"),s=s(),A(),s),P=b(()=>d("h2",null,"更换头像",-1)),R={style:{"margin-top":"20px"}},F=["src"],M={__name:"UserAvatar",setup(s){const c=g(),e=p();(()=>{try{e.value=c.user.user_pic}catch(a){console.error("获取头像失败",a)}})();const n=p(),f=a=>{const t=new FileReader;t.readAsDataURL(a.raw),t.onload=()=>{e.value=t.result}},v=async()=>{if(!e.value){ElMessage.error("请先选择图片");return}try{await w(e.value),await c.getUser(),ElMessage.success("头像上传成功")}catch(a){console.error("上传头像失败",a),ElMessage.error("上传头像失败")}};return(a,t)=>{const m=E("Plus"),h=U,y=C,u=S;return l(),_(B,null,{default:o(()=>[P,d("div",R,[r(y,{ref_key:"uploadRef",ref:n,"auto-upload":!1,class:"avatar-uploader","show-file-list":!1,"on-change":f},{default:o(()=>[e.value?(l(),k("img",{key:0,src:e.value,class:"avatar"},null,8,F)):(l(),_(h,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[r(m)]),_:1}))]),_:1},512),r(u,{onClick:t[0]||(t[0]=V=>n.value.$el.querySelector("input").click()),size:"small",type:"primary"},{default:o(()=>[i("选择图片")]),_:1}),r(u,{size:"small",type:"success",onClick:v},{default:o(()=>[i("上传头像")]),_:1})])]),_:1})}}},T=I(M,[["__scopeId","data-v-2b0c9f31"]]);export{T as default};
