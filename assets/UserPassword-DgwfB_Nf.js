import{q as _,s as n,o as v,a as g,w as a,y as b,v as r,x as w,bX as V}from"./index-BZ6anzCx.js";import{a as x,E,b as y}from"./el-form-item-CKSfSFL9.js";import{E as F}from"./_plugin-vue_export-helper-bd0Rmxjf.js";import{P as C}from"./PageContainer-Cgg-xLYz.js";import"./index-Dd-0atpK.js";import"./_baseClone-BqTtZK27.js";const j={__name:"UserPassword",setup(U){const i=_(),u=n(null),e=n({oldPassword:"",newPassword:"",confirmPassword:""}),p=n({oldPassword:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码长度需在6-15位之间，且不能包含空格",trigger:"blur"},{validator:(t,o,s)=>{o===e.value.oldPassword?s(new Error("新密码不能与原密码相同")):s()},trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:(t,o,s)=>{o!==e.value.newPassword?s(new Error("两次输入密码不一致")):s()},trigger:"blur"}]}),f=()=>{u.value.validate(async t=>{if(t){const o={old_pwd:e.value.oldPassword,new_pwd:e.value.newPassword,re_pwd:e.value.confirmPassword};await V(o),ElMessage.success("修改密码成功,请重新登陆"),i.removeToken(),setTimeout(()=>{location.reload()},2e3)}else return!1})},c=()=>{u.value.resetFields()};return(t,o)=>{const s=x,d=E,m=F,P=y;return v(),g(C,null,{default:a(()=>[b("div",null,[r(P,{model:e.value,rules:p.value,ref_key:"refForm",ref:u,"label-width":"100px"},{default:a(()=>[r(d,{label:"原密码",prop:"oldPassword"},{default:a(()=>[r(s,{style:{width:"300px"},modelValue:e.value.oldPassword,"onUpdate:modelValue":o[0]||(o[0]=l=>e.value.oldPassword=l),"show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),r(d,{label:"新密码",prop:"newPassword"},{default:a(()=>[r(s,{style:{width:"300px"},modelValue:e.value.newPassword,"onUpdate:modelValue":o[1]||(o[1]=l=>e.value.newPassword=l),"show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),r(d,{label:"确认新密码",prop:"confirmPassword"},{default:a(()=>[r(s,{style:{width:"300px"},modelValue:e.value.confirmPassword,"onUpdate:modelValue":o[2]||(o[2]=l=>e.value.confirmPassword=l),"show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),r(d,null,{default:a(()=>[r(m,{type:"primary",onClick:f},{default:a(()=>[w("提交")]),_:1}),r(m,{onClick:c},{default:a(()=>[w("重置")]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1})}}};export{j as default};
