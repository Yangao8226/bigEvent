import{q as g,s as m,o as v,a as b,w as a,y as V,v as o,e as l,x as i,bZ as E,E as x}from"./index-DU7TYByl.js";import{E as y,a as F}from"./el-form-item-BRRqcIoR.js";import{E as C}from"./_plugin-vue_export-helper-AEV-r0sw.js";import{E as U}from"./el-input-V8fqKQd6.js";import{P as N}from"./PageContainer-BZ-6BrCx.js";/* empty css                   */import"./_baseClone-TyZT292g.js";const $={__name:"UserPassword",setup(k){const p=g(),u=m(null),e=m({oldPassword:"",newPassword:"",confirmPassword:""}),f=m({oldPassword:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码长度需在6-15位之间，且不能包含空格",trigger:"blur"},{validator:(d,r,s)=>{r===e.value.oldPassword?s(new Error("新密码不能与原密码相同")):s()},trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:(d,r,s)=>{r!==e.value.newPassword?s(new Error("两次输入密码不一致")):s()},trigger:"blur"}]}),c=()=>{u.value.validate(async d=>{if(d){const r={old_pwd:e.value.oldPassword,new_pwd:e.value.newPassword,re_pwd:e.value.confirmPassword};await E(r),x.success("修改密码成功,请重新登陆"),p.removeToken(),setTimeout(()=>{location.reload()},2e3)}else return!1})},P=()=>{u.value.resetFields()};return(d,r)=>{const s=U,n=y,w=C,_=F;return v(),b(N,null,{default:a(()=>[V("div",null,[o(_,{model:l(e),rules:l(f),ref_key:"refForm",ref:u,"label-width":"100px"},{default:a(()=>[o(n,{label:"原密码",prop:"oldPassword"},{default:a(()=>[o(s,{style:{width:"300px"},modelValue:l(e).oldPassword,"onUpdate:modelValue":r[0]||(r[0]=t=>l(e).oldPassword=t),"show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(n,{label:"新密码",prop:"newPassword"},{default:a(()=>[o(s,{style:{width:"300px"},modelValue:l(e).newPassword,"onUpdate:modelValue":r[1]||(r[1]=t=>l(e).newPassword=t),"show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(n,{label:"确认新密码",prop:"confirmPassword"},{default:a(()=>[o(s,{style:{width:"300px"},modelValue:l(e).confirmPassword,"onUpdate:modelValue":r[2]||(r[2]=t=>l(e).confirmPassword=t),"show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(n,null,{default:a(()=>[o(w,{type:"primary",onClick:c},{default:a(()=>[i("提交")]),_:1}),o(w,{onClick:P},{default:a(()=>[i("重置")]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1})}}};export{$ as default};
