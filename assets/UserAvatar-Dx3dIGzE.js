import{q as k,s as _,X as w,o as l,a as i,w as o,y as f,v as r,J as E,x as d,E as c,bO as U,K as x,F as A,G as S}from"./index-BRWiflxj.js";import{_ as C,E as I}from"./plugin-vueexport-helper-CZ20MfyZ.js";import{E as B}from"./el-progress-CZLu0vFV.js";import{P as b}from"./PageContainer-BCk6e3Sv.js";/* empty css                   */import"./_baseClone-DTZsyfuP.js";import"./isEqual-BSIdeUtt.js";const P=s=>(A("data-v-2b0c9f31"),s=s(),S(),s),R=P(()=>f("h2",null,"更换头像",-1)),F={style:{"margin-top":"20px"}},N=["src"],V={__name:"UserAvatar",setup(s){const n=k(),e=_();(()=>{try{e.value=n.user.user_pic}catch(a){console.error("获取头像失败",a)}})();const u=_(),m=a=>{const t=new FileReader;t.readAsDataURL(a.raw),t.onload=()=>{e.value=t.result}},v=async()=>{if(!e.value){c.error("请先选择图片");return}try{await U(e.value),await n.getUser(),c.success("头像上传成功")}catch(a){console.error("上传头像失败",a),c.error("上传头像失败")}};return(a,t)=>{const h=w("Plus"),y=x,g=B,p=I;return l(),i(b,null,{default:o(()=>[R,f("div",F,[r(g,{ref_key:"uploadRef",ref:u,"auto-upload":!1,class:"avatar-uploader","show-file-list":!1,"on-change":m},{default:o(()=>[e.value?(l(),E("img",{key:0,src:e.value,class:"avatar"},null,8,N)):(l(),i(y,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[r(h)]),_:1}))]),_:1},512),r(p,{onClick:t[0]||(t[0]=z=>u.value.$el.querySelector("input").click()),size:"small",type:"primary"},{default:o(()=>[d("选择图片")]),_:1}),r(p,{size:"small",type:"success",onClick:v},{default:o(()=>[d("上传头像")]),_:1})])]),_:1})}}},O=C(V,[["__scopeId","data-v-2b0c9f31"]]);export{O as default};
